graphics_toolkit gnuplot

%data = dlmread('49.csv', ',', 1, 2);
%p = [2062.6480624709634,2062.656042863256,2062.763998634137,2063.381820510115,2064.948602523619,2067.8099400017513,2072.263877549464,2078.241925028205,2085.8920635081704,2094.7724074645594,2104.6819888880605,2115.362638350466,2126.0400626508954,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2128.2125460936704,2943.0368684756545,2953.7149620544274,2964.401589809645,2974.3251381309146,2983.22592639033,2990.901218212234,2996.906047145118,3001.387008803193,3004.272469762254,3005.8587219816472,3006.4892913932795,3006.6018354433063,3006.609940057921]
v = [0.0,-0.06297278356502134,-0.09725368295791548,-0.07415081400655521,0.03502770746118622,0.25897376561743646,0.6263792446343226,1.1659360286839715,1.9063360019385107,2.874143047085149,4.071183029548917,5.48332180361796,7.0961592233948,8.89529514298197,10.866329416482001,12.994861897997419,15.266492441630746,17.666820901484513,20.18144713166126,22.7959709862635,25.495992319393764,28.267110985154577,31.094926837648487,33.965039730978,36.86304951924565,39.77455605655396,42.68515919700546,45.580458794702714,48.4460547037482,51.267546778244466,54.03053487229405,56.72061883999945,59.32339853546323,61.824473812787886,64.20944452607597,66.46391052943001,68.57347167695252,70.52372782274603,72.30027882091308,73.88872452555619,75.27466479077788,76.4436994706807,77.38171449503848,78.09176033390438,78.60349249476441,78.94885509047526,79.15979223389351,79.26824803787582,79.30616661527877,79.30549207895902,79.2981685417732,79.30549207895902,79.30616661527878,79.26824803787582,79.15979223389351,78.94885509047526,78.60349249476441,78.09176033390435,77.38171449503847,76.4436994706807,75.27466479077786,73.88872452555619,72.30027882091306,70.52372782274603,68.57347167695251,66.46391052943,64.20944452607598,61.82447381278787,59.32339853546322,56.720618839999446,54.03053487229403,51.267546778244466,48.44605470374818,45.58045879470269,42.68515919700547,39.774556056553955,36.86304951924562,33.96503973097799,31.094926837648465,28.267110985154577,25.495992319393746,22.79597098626348,20.18144713166123,17.666820901484524,15.266492441630753,12.994861897997412,10.866329416481989,8.895295142981958,7.096159223394779,5.483321803617961,4.071183029548913,2.874143047085145,1.9063360019385043,1.1659360286839646,0.626379244634324,0.25897376561743657,0.03502770746118589,-0.07415081400655552,-0.09725368295791512,-0.06297278356502138,0.0];
t = [0.0,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.3438534833418565,6.343853483341863,6.343853483341849,6.343853483341849,6.343853483341863,6.343853483341863,6.343853483341849,6.343853483341849,6.343853483341863,6.343853483341863,6.343853483341849,6.343853483341849,6.343853483341877,6.343853483341849,6.343853483341849,6.343853483341849,6.343853483341849,6.343853483341877,6.343853483341849,6.343853483341849,6.343853483341877,6.343853483341849,6.343853483341849,6.343853483341849,6.343853483341849,6.343853483341877,6.343853483341849,6.343853483341849,6.343853483341877,6.343853483341849,6.343853483341849,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341821,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341766,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341766,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341766,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341877,6.343853483341766,6.343853483341877];
%p = cumtrapz(cumsum(t)*1e-3, v);

praw.p = data(:, 1);
praw.v = data(:, 2);
praw.t = data(:, 3) * 1e-3;

praw.p = p;
praw.v = v;
praw.t = t * 1e-3;


for V = praw.v(2) : -1 : 1
  v1 = linspace(0, V);
  t1 = linspace(0, praw.t(2));
  s1 = trapz(v1, t1);

  t2 = praw.t(3);
  s2 = V * t2;


  v3 = linspace(0, V);
  t3 = linspace(0, praw.t(4));
  s3 = trapz(v3, t3);

  V;
  s = s1 + s2 + s3;
  '-'
end

pt.p = deg2rad(data(:, 1));
pt.v = deg2rad(data(:, 2));
pt.t = cumsum(data(:, 3)) * 1e-3;
pt.a = pt.t * 0;

pt.p = deg2rad(p);
pt.v = deg2rad(v);
pt.t = cumsum(t) * 1e-3;
pt.a = pt.t * 0;

dt = 1e-2;

[t, q] = qupsample(pt, dt);

subplot(2, 1, 1); plot(t, rad2deg(q)); grid;
hold on;
plot(pt.t, rad2deg(pt.p), '-');
hold off
vq = [0 diff(rad2deg(q)/dt)];

subplot(2, 1, 2); plot(t, vq); grid;
hold on;
plot(pt.t, rad2deg(pt.v), '-');
hold off;

s_real = sum(vq)*dt
s_estimated = praw.p(size(praw.p)(1)) - praw.p(1)
pause